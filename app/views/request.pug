extends layouts/layout.pug

block pageTitle
	- var title_en="Requests Management | SNB RDD"
	- var title_ar="Requests Management | SNB RDD"
	- var desc_en=""
	- var isAdmin=false
	- var isRequester=true
	- var desc_ar=''
	- var link_en=""
	- var link_ar=""

block content
	-
		const users = [
			{ initials: 'KH', name: 'Khalid Hafiz', email: 'strah.j@example.com' },
			{ initials: 'MR', name: 'Maryam Radwan', email: 'strah.j@example.com' },
			{ initials: 'LT', name: 'Lamia Tariq', email: 'John.smith@example.com' },
			{ initials: 'AM', name: 'Abdul Majeed', email: 'John.smith@example.com' },
			{ initials: 'HA', name: 'Hassan Al-Omran', email: 'strah.j@example.com' },
			{ initials: 'MF', name: 'Maha Faisal Alsanooni', email: 'strah.j@example.com' }
		]

	-
		const sidebarData = [
			{ link: "#", name:"Requests" },
			//- { link: "#", name:"test2"},
			//- { link: "#", name:"test3"},
		]

	.flex.bg-gray-100.min-h-screen
		+sidebar(sidebarData)

		// Main Content
		.flex-1.p-6.pb-0
			.flex.justify-between.items-center.mb-6
				h1.text-xl.font-semibold Requests
				.flex.space-x-2
					+btn('New Request', 'new-request.html', 'add', '18')

			div(class="bg-white p-4 rounded relative")
				// Loader Overlay
				#loaderOverlay.hidden.fixed.inset-0(class="bg-white/80 flex items-center justify-center z-50")
					.h-12.w-12.border-4.border-green.border-t-transparent.rounded-full.animate-spin

				// Success Message
				#successMsg.hidden.text-green.text-center.font-medium.mb-4 User has been added successfully!

				.flex.gap-4.mb-4
					+formInput("", "Search By Job Number...", "text", "searchInput", "", "w-[40%]")
					+formSelect("", "All Status", ["Approved", "Pending", "Rejected"], "", 'min-w-[17vw]')
					+formSelect("", "All Types", ["Marketing", "Public Relation", "Brand"], "", 'min-w-[17vw]')
					+formInput("", "mm/dd/yyyy", "date", "data", "", "w-[15vw]")

				//- Table Container
				.bg-white.shadow-sm.rounded-md.overflow-hidden
					//- Table Title
					.bg-gray-50.px-6.py-3.text-sm.font-semibold.text-gray-600.border-b.border-gray-200
						| Recent Requests

					//- Table Body
					table.w-full.text-sm.text-left.text-gray-700
						thead.text-xs.uppercase.text-gray-500.bg-gray-100
							tr
								th.px-6.py-3.font-semibold Job Number
								th.px-6.py-3.font-semibold Request Title
								th.px-6.py-3.font-semibold Request Type
								th.px-6.py-3.font-semibold Status
								th.px-6.py-3.font-semibold Date
								th.px-6.py-3.font-semibold.text-center Action
						tbody#requestsTable
							tr.bg-white.border-b
								td.px-6.py-4.font-bold.text-gray-800 SNB-001
								td.px-6.py-4.font-medium Press Release for New Product
								td.px-6.py-4.font-medium Public Relation
								td.px-6.py-4.font-medium.text-yellow-600 Pending
								td.px-6.py-4.font-medium.text-gray-700 Jan 15 2025
								td.px-6.py-4.text-center
									i.material-symbols-outlined(style=`font-size: 24px`, class='rtl:rotate-[270deg]') visibility

							tr.bg-white.border-b
								td.px-6.py-4.font-bold SNB-002
								td.px-6.py-4.font-medium Summer Sales Promotion
								td.px-6.py-4.font-medium Marketing
								td.px-6.py-4.font-medium.text-green Approved
								td.px-6.py-4.font-medium Jan 10 2025
								td.px-6.py-4.text-center
									i.material-symbols-outlined(style=`font-size: 24px`, class='rtl:rotate-[270deg]') visibility

							tr.bg-white.border-b
								td.px-6.py-4.font-bold SNB-003
								td.px-6.py-4.font-medium Rebranding Initiative
								td.px-6.py-4.font-medium Brand
								td.px-6.py-4.font-medium.text-red-600 Rejected
								td.px-6.py-4.font-medium Jan 5, 2025
								td.px-6.py-4.text-center
									i.material-symbols-outlined(style=`font-size: 24px`, class='rtl:rotate-[270deg]') visibility

							tr#noResultsRow(style="display: none")
								td(colspan="6" class="text-center text-gray-500 py-4") No results found.

					//- Footer
					.px-6.py-2.text-sm.text-gray-500.bg-gray-50.border-t.border-gray-200
						| Showing 1-3 of 12 rows

	script.
		document.addEventListener("DOMContentLoaded", function () {
			const navLinks = document.querySelectorAll('.md\\:space-x-8 a'); 
			const currentPage = window.location.pathname.split('/').pop(); 

			navLinks.forEach(link => {
				const href = link.getAttribute('href');
				if (href === currentPage) {
					// Make active
					link.classList.remove('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
					link.classList.add('border-primary-500', 'text-gray-900');
				} else {
					// Make inactive
					link.classList.remove('border-primary-500', 'text-gray-900');
					link.classList.add('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
				}
			});
		});
		document.getElementById("searchInput").addEventListener("input", function () {
			const filter = this.value.toUpperCase();
			const rows = document.querySelectorAll("#requestsTable tr:not(#noResultsRow)");
			const noResultsRow = document.getElementById("noResultsRow");
			let visibleCount = 0;

			rows.forEach(row => {
				const jobNumberCell = row.cells[0]; // First cell: Job Number
				const jobNumber = jobNumberCell.textContent || jobNumberCell.innerText;

				if (jobNumber.toUpperCase().indexOf(filter) > -1) {
					row.style.display = "";
					visibleCount++;
				} else {
					row.style.display = "none";
				}
			});

			// Show or hide the "No results found" row
			noResultsRow.style.display = visibleCount === 0 ? "" : "none";
		});
